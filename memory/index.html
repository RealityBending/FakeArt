<!DOCTYPE html>
<html>
    <head>
        <title>Experiment</title>
        <script src="https://unpkg.com/jspsych@8.2.2"></script>
        <script src="https://unpkg.com/@jspsych/plugin-browser-check@2.1.0"></script>
        <script src="https://unpkg.com/@jspsych/plugin-html-keyboard-response@2.1.0"></script>
        <script src="https://unpkg.com/@jspsych/plugin-image-keyboard-response@2.1.0"></script>
        <script src="https://unpkg.com/@jspsych/plugin-html-button-response@2.1.0"></script>
        <script src="https://unpkg.com/@jspsych/plugin-preload@2.1.0"></script>
        <script src="https://unpkg.com/@jspsych/plugin-fullscreen@2.1.0"></script>
        <script src="https://unpkg.com/@jspsych/plugin-survey@3.0.0"></script>
        <link rel="stylesheet" href="https://unpkg.com/@jspsych/plugin-survey@3.0.0/css/survey.css" />
        <link href="https://unpkg.com/jspsych@8.2.2/css/jspsych.css" rel="stylesheet" type="text/css" />

        <script src="https://unpkg.com/@jspsych-contrib/plugin-pipe@0.5.0"></script>

        <script src="stimuli_list.js"></script>
        <script src="consent.js"></script>
        <script src="instructions.js"></script>
        <script src="memory.js"></script>
    </head>
    <body></body>
    <script>
        /* initialize jsPsych */
        var jsPsych = initJsPsych({
            show_progress_bar: "true",
            message_progress_bar: "Progress",
            on_finish: function () {
                jsPsych.data.displayData("json")
            },
        })

        /* create timeline */
        var timeline = []
        const subject_id = jsPsych.randomization.randomID(10) // random ID generation (to test DataPipe and OSF), but maybe using self-generated ID instead???
        const filename = `${subject_id}.csv`

        /* enter fullscreen */
        var fullscreen_text = "<p>The experiment will switch to full screen mode when you press the button below.</p>"
        var fullscreen_button = "Continue"

        var fullscreen_on = {
            type: jsPsychFullscreen,
            message: fullscreen_text,
            button_label: fullscreen_button,
            fullscreen_mode: true,
            delay_after: 0,
        }

        var fullscreen_off = {
            type: jsPsychFullscreen,
            message: fullscreen_text,
            button_label: fullscreen_button,
            fullscreen_mode: false,
        }

        timeline.push(fullscreen_on)

        timeline.push(memory_preloadstims)

        //  /* consent */
        //  timeline.push(consent);

        //   /* instructions 1 */
        //   timeline.push(memory_instructions_1);

        //   /* instructions 2 */
        //   timeline.push(memory_instructions_2);

        /*experimental trials */
        timeline.push(memory_phase)

        /* debriefing */
        timeline.push(debrief)

        /* saving data via DataPipe
    timeline.push({
    type: jsPsychPipe,
    action: "save",
    experiment_id: "cGSVw8AnfxEJ",
    filename: filename,
    data_string: ()=>jsPsych.data.get().csv()
              }); */ // NOT NECESSARY YET

        /* end of experiment */
        timeline.push(endscreen)
        timeline.push(fullscreen_off)

        /* run timeline */
        jsPsych.run(timeline)
    </script>
</html>
